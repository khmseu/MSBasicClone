<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MSBasic - Applesoft BASIC Interpreter: Applesoft BASIC Clone</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MSBasic - Applesoft BASIC Interpreter<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">A modern C++20 implementation of Applesoft II BASIC</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Applesoft BASIC Clone </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> A modern implementation of the Applesoft II BASIC interpreter written in C++20, targeting compatibility with the classic Apple II BASIC dialect.</p>
<h1><a class="anchor" id="autotoc_md226"></a>
Documentation</h1>
<ul>
<li><b><a class="el" href="md_docs_2architecture.html">Architecture Documentation</a></b>: Comprehensive system architecture overview</li>
<li><b><a class="el" href="md_docs_2features.html">Implementation Features</a></b>: Complete feature status and implementation notes</li>
<li><b><a class="el" href="md_docs_2docs__overview.html">API Documentation</a></b>: Instructions for building Doxygen API docs</li>
</ul>
<h1><a class="anchor" id="autotoc_md227"></a>
Features</h1>
<h2><a class="anchor" id="autotoc_md228"></a>
Implemented</h2>
<ul>
<li><b>Interactive Mode</b>: Classic "]" prompt with immediate command execution</li>
<li><b>Script Mode</b>: Execute BASIC programs from files</li>
<li><b><a class="el" href="classVariables.html" title="Storage and management for program variables, arrays, and functions.">Variables</a></b>:<ul>
<li>Numeric and string variables (with $ suffix for strings)</li>
<li>Integer variables (with % suffix, 16-bit clamped)</li>
<li>First two characters significant for variable names</li>
</ul>
</li>
<li><b>Arrays</b>:<ul>
<li>Multi-dimensional arrays with DIM</li>
<li>Auto-DIM to size 10 per dimension if undeclared</li>
</ul>
</li>
<li><b>Operators</b>: Arithmetic (+, -, *, /, ^, MOD), comparison (=, &lt;&gt;, &lt;, &gt;, &lt;=, &gt;=), logical (AND, OR, NOT)</li>
<li><b>Control Flow</b>:<ul>
<li>IF/THEN/ELSE statements</li>
<li>FOR/NEXT loops (with STEP support)</li>
<li>WHILE/WEND loops</li>
<li>GOTO statements</li>
<li>GOSUB/RETURN subroutines</li>
<li>ON...GOTO/GOSUB statements</li>
<li>POP (clear GOSUB stack)</li>
</ul>
</li>
<li><b>Data Handling</b>:<ul>
<li>DATA/READ/RESTORE statements</li>
<li>RESTORE with optional line number</li>
</ul>
</li>
<li><b>User-Defined Functions</b>: DEF FN with parameters</li>
<li><b>Error Handling</b>: ONERR GOTO and RESUME statements</li>
<li><b>Built-in Commands</b>:<ul>
<li>NEW, RUN, LIST, END, STOP, CONT (continue after STOP)</li>
<li>LOAD, SAVE, CATALOG</li>
<li>DEL (delete line range)</li>
<li>RECALL/STORE (load/save arrays to files or tape)</li>
<li>TAPE (set/view current tape file)</li>
<li>SHLOAD (load shape tables from files or tape)</li>
<li>INPUT (with optional prompts)</li>
<li>GET (single character input)</li>
<li>LET (assignment, also works without LET keyword)</li>
<li>CLR (clear variables and control stacks)</li>
<li>REM (comments)</li>
<li>HOME (clear screen)</li>
<li>TEXT (switch to text mode)</li>
</ul>
</li>
<li><b>Math Functions</b>: SIN, COS, TAN, ATN, EXP, LOG, SQR, ABS, INT, SGN, RND, RANDOMIZE</li>
<li><b>String Functions</b>: LEFT$, RIGHT$, MID$, LEN, CHR$, ASC, VAL, STR$</li>
<li><b>Memory Commands</b>:<ul>
<li>PEEK/POKE with bounds checking</li>
<li>CALL (machine language call stub)</li>
<li>WAIT with optional timeout</li>
<li>LOMEM/HIMEM (memory bounds)</li>
<li>FRE (free memory)</li>
<li>USR (user machine code stub)</li>
</ul>
</li>
<li><b>Screen Control</b>:<ul>
<li>HTAB/VTAB (cursor positioning)</li>
<li>INVERSE/NORMAL/FLASH (text attributes)</li>
<li><a class="el" href="types_8h.html#aa520fbf142ba1e7e659590c07da31921af684bf05fa3e81528c84d1d281d839f1">TAB()</a>, <a class="el" href="types_8h.html#aa520fbf142ba1e7e659590c07da31921aa9ba851e539886467d4ecfddca93f414">SPC()</a>, <a class="el" href="types_8h.html#aa520fbf142ba1e7e659590c07da31921a1903f54cd46d54aa3200a4508c948db0">POS()</a> functions</li>
</ul>
</li>
<li><b><a class="el" href="classGraphics.html" title="Singleton managing graphics state and operations.">Graphics</a> Commands</b>:<ul>
<li>GR, HIRES, HGR, HGR2 (mode switching)</li>
<li>COLOR=, HCOLOR= (color selection)</li>
<li>PLOT, HPLOT (plotting points)</li>
<li>HLIN, VLIN (line drawing)</li>
<li>DRAW, XDRAW (shape drawing)</li>
<li>MOVE, ROTATE, SCALE (shape transformations)</li>
<li>SHLOAD (shape table loading)</li>
<li><a class="el" href="types_8h.html#aa520fbf142ba1e7e659590c07da31921acc06370fc7df708112ed2e2a79bc3b4c">SCRN()</a> function (read pixel color)</li>
<li>Window rendering with Raylib (when available and display present)</li>
<li>Graceful fallback to off-screen buffer when no display</li>
</ul>
</li>
<li><b>Debugging</b>: TRACE/NOTRACE (line number display), SPEED (execution delay)</li>
<li><b>ProDOS Support</b>:<ul>
<li>PR::n, IN::n (I/O redirection)</li>
<li>PR#0 (40-column text mode)</li>
<li>PR#3 (80-column text mode)</li>
</ul>
</li>
<li><b>40-bit Floating Point</b>: Emulated Applesoft floating-point precision</li>
<li><b>Cross-Platform</b>: Compiles on Linux, macOS, and Windows</li>
</ul>
<h1><a class="anchor" id="autotoc_md229"></a>
Building</h1>
<h2><a class="anchor" id="autotoc_md230"></a>
Requirements</h2>
<ul>
<li>CMake 3.20 or later</li>
<li>GCC 13 or Clang 18 (or compatible)</li>
<li>C++20 support</li>
<li>Raylib 5.0+ (optional, for graphics rendering)</li>
<li>X11 development libraries (optional, for graphics on Linux)</li>
</ul>
<h2><a class="anchor" id="autotoc_md231"></a>
Build Instructions</h2>
<div class="fragment"><div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line">cmake ..</div>
<div class="line">make</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md232"></a>
Automatic Raylib Build</h3>
<p>By default, the build system will automatically download and build Raylib from source if it's not found on your system. This requires:</p>
<p><b>Linux:</b></p>
<div class="fragment"><div class="line"># Install X11 development libraries first</div>
<div class="line">sudo apt-get install libx11-dev libxrandr-dev libxinerama-dev libxcursor-dev libxi-dev libgl1-mesa-dev</div>
</div><!-- fragment --><p><b>macOS:</b> No additional dependencies needed - Raylib will build automatically.</p>
<p><b>Windows:</b> Raylib will build automatically with MinGW or MSVC.</p>
<p>To disable automatic Raylib building:</p>
<div class="fragment"><div class="line">cmake -DAUTO_BUILD_RAYLIB=OFF ..</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md233"></a>
Manual Raylib Installation (Alternative)</h3>
<p>If you prefer to install Raylib manually:</p>
<p><b>Ubuntu/Debian:</b></p>
<div class="fragment"><div class="line"># Install dependencies</div>
<div class="line">sudo apt-get install libx11-dev libxrandr-dev libxinerama-dev libxcursor-dev libxi-dev libgl1-mesa-dev</div>
<div class="line"> </div>
<div class="line"># Clone and build Raylib</div>
<div class="line">git clone --depth 1 --branch 5.0 https://github.com/raysan5/raylib.git</div>
<div class="line">cd raylib</div>
<div class="line">cmake -S . -B build -DCMAKE_BUILD_TYPE=Release -DBUILD_EXAMPLES=OFF</div>
<div class="line">cd build</div>
<div class="line">make</div>
<div class="line">sudo make install</div>
</div><!-- fragment --><p><b>macOS:</b></p>
<div class="fragment"><div class="line">brew install raylib</div>
</div><!-- fragment --><p>The build system will detect Raylib whether installed manually or built automatically. Without Raylib, graphics commands will use off-screen buffers only.</p>
<h2><a class="anchor" id="autotoc_md234"></a>
Bundled Font Files</h2>
<p>The Ultimate Apple II Font and related files are <b>bundled in the repository</b> for reliable builds:</p>
<ul>
<li><b>Font</b>: <code>PrintChar21.ttf</code> - The Ultimate Apple II Font (7Ã—8 pixel characters)</li>
<li><b>Charset Map</b>: <code>apple2-charset.html</code> - Apple II character set reference</li>
<li><b>License</b>: <code>FreeLicense.txt</code> - Font license from Kreative Korporation</li>
<li><b>Source</b>: <a href="https://www.kreativekorp.com/software/fonts/apple2/">https://www.kreativekorp.com/software/fonts/apple2/</a></li>
</ul>
<p>These files are located in <code>assets/fonts/</code> and are tracked in git. The build system uses them automatically.</p>
<p>To refresh the bundled files from upstream (optional):</p>
<div class="fragment"><div class="line">cmake -S . -B build -DREFRESH_BUNDLED_FONTS=ON</div>
</div><!-- fragment --><p>For more details, see <code>assets/fonts/fonts_overview.md</code>.</p>
<h2><a class="anchor" id="autotoc_md235"></a>
Building with Clang</h2>
<div class="fragment"><div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line">CXX=clang++ cmake ..</div>
<div class="line">make</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md236"></a>
Versioning</h2>
<p>The build derives the version from <code>git describe --tags --dirty --always</code> (uses the output verbatim). If git data is unavailable, it falls back to <code>1.0.0</code> or a <code>-DVERSION_OVERRIDE=...</code> value passed to CMake. CPack picks up the same string via <code>CPACK_PACKAGE_VERSION</code>.</p>
<h1><a class="anchor" id="autotoc_md237"></a>
Testing</h1>
<p>Configure and build, then run the BASIC script tests via CTest (each <code>tests/*.bas</code> and <code>examples/*.bas</code> is executed and must exit cleanly):</p>
<div class="fragment"><div class="line">cmake -S . -B build</div>
<div class="line">cmake --build build</div>
<div class="line">cd build</div>
<div class="line">ctest</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md238"></a>
Usage</h1>
<h2><a class="anchor" id="autotoc_md239"></a>
Interactive Mode</h2>
<p>Run without arguments to start the interactive REPL:</p>
<div class="fragment"><div class="line">./msbasic</div>
</div><!-- fragment --><p>You'll see the Applesoft-style prompt:</p>
<div class="fragment"><div class="line">APPLESOFT II BASIC CLONE &lt;git describe output&gt;</div>
<div class="line">Compatible with Applesoft BASIC</div>
<div class="line"> </div>
<div class="line">]</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md240"></a>
Script Mode</h2>
<p>Run a BASIC program from a file:</p>
<div class="fragment"><div class="line">./msbasic program.bas</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md241"></a>
Graphics Mode Options</h2>
<p>The interpreter supports two modes for graphics handling:</p>
<div class="fragment"><div class="line"># Run with graphics rendering enabled (default)</div>
<div class="line">./msbasic --graphics program.bas</div>
<div class="line"> </div>
<div class="line"># Run in no-graphics mode (graphics commands will error)</div>
<div class="line">./msbasic --no-graphics program.bas</div>
<div class="line"> </div>
<div class="line"># Set window scale factor (1-10, default is 2)</div>
<div class="line">./msbasic --scale 3 program.bas</div>
<div class="line"> </div>
<div class="line"># Set default tape file for STORE/RECALL/SHLOAD</div>
<div class="line">./msbasic --tape /tmp/mytape.tap program.bas</div>
<div class="line"> </div>
<div class="line"># Set tape change hotkey (default: ESC-T)</div>
<div class="line">./msbasic --tape-hotkey &quot;^T&quot; program.bas</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md242"></a>
Tape Emulation</h2>
<p>The interpreter supports cassette tape emulation for array and shape table persistence:</p>
<p><b>Using command-line:</b></p>
<div class="fragment"><div class="line">./msbasic --tape /tmp/mytape.tap program.bas</div>
</div><!-- fragment --><p><b>Using BASIC commands:</b></p>
<div class="fragment"><div class="line">10 TAPE &quot;/tmp/mytape.tap&quot;    REM Set current tape file (rewinds)</div>
<div class="line">20 DIM A(5), B(5)</div>
<div class="line">30 FOR I = 0 TO 5: A(I) = I * 10: NEXT I</div>
<div class="line">40 FOR I = 0 TO 5: B(I) = I * 100: NEXT I</div>
<div class="line">50 STORE A                    REM Save first array</div>
<div class="line">60 STORE B                    REM Save second array (appends, maintains position)</div>
<div class="line">70 TAPE &quot;/tmp/mytape.tap&quot;    REM Set tape again to rewind</div>
<div class="line">80 RECALL A                   REM Read first array</div>
<div class="line">90 RECALL B                   REM Read second array (position maintained)</div>
</div><!-- fragment --><p><b>Tape Features:</b></p>
<ul>
<li>Sequential record format with SIZE|DATA headers</li>
<li>Supports arrays (numeric and string) via STORE/RECALL</li>
<li>Supports shape tables via SHLOAD</li>
<li>Falls back to file-based storage when no tape loaded</li>
<li>Use <code>TAPE</code> with no argument to view current tape</li>
<li>OS-native file selector support (zenity/kdialog on Linux, osascript on macOS, COM on Windows)</li>
<li><b>Tape maintains position across operations</b> - only rewinds when setting a new tape file</li>
</ul>
<p><b>Note:</b> The tape file stays open and maintains position between STORE/RECALL/SHLOAD operations, allowing sequential reading/writing of multiple records. Use <code>TAPE "filename"</code> to rewind to the beginning.</p>
<p><b><a class="el" href="classGraphics.html" title="Singleton managing graphics state and operations.">Graphics</a> Mode</b> (default): When graphics are enabled, the interpreter will attempt to open a window for rendering graphics commands (GR, HGR, HPLOT, etc.). If no display is available (e.g., in a headless environment), graphics will fall back to off-screen buffer mode only.</p>
<p><b>No-Graphics Mode</b>: All graphics commands (GR, HGR, PLOT, HPLOT, etc.) will raise a "GRAPHICS NOT ENABLED ERROR" when executed. This is useful for running programs in terminal-only environments or for testing.</p>
<h2><a class="anchor" id="autotoc_md243"></a>
Text Mode Commands</h2>
<p>The interpreter supports 40-column and 80-column text modes via the PR# command:</p>
<ul>
<li><code>PR#0</code> - Switch to 40-column text mode (default)</li>
<li><code>PR#3</code> - Switch to 80-column text mode</li>
</ul>
<p>These commands are compatible with Applesoft BASIC conventions for peripheral slot I/O redirection.</p>
<h1><a class="anchor" id="autotoc_md244"></a>
Example Programs</h1>
<h2><a class="anchor" id="autotoc_md245"></a>
Hello World</h2>
<div class="fragment"><div class="line">10 PRINT &quot;HELLO, WORLD!&quot;</div>
<div class="line">20 END</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md246"></a>
Fibonacci Sequence</h2>
<div class="fragment"><div class="line">10 REM FIBONACCI SEQUENCE</div>
<div class="line">20 PRINT &quot;FIBONACCI NUMBERS:&quot;</div>
<div class="line">30 LET A = 0</div>
<div class="line">40 LET B = 1</div>
<div class="line">50 FOR I = 1 TO 10</div>
<div class="line">60 PRINT A</div>
<div class="line">70 LET C = A + B</div>
<div class="line">80 LET A = B</div>
<div class="line">90 LET B = C</div>
<div class="line">100 NEXT I</div>
<div class="line">110 END</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md247"></a>
Subroutine Example</h2>
<div class="fragment"><div class="line">10 PRINT &quot;MAIN&quot;</div>
<div class="line">20 GOSUB 100</div>
<div class="line">30 PRINT &quot;BACK IN MAIN&quot;</div>
<div class="line">40 END</div>
<div class="line">100 PRINT &quot;IN SUBROUTINE&quot;</div>
<div class="line">110 RETURN</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md248"></a>
Applesoft II Compatibility</h1>
<p>This interpreter aims for source-code compatibility with Applesoft II BASIC as it appeared on the Apple II+, IIe, IIc, and IIGS. Key compatibility features:</p>
<ul>
<li>Only first 2 characters of variable names are significant (except for string and array variables)</li>
<li>40-bit floating-point precision</li>
<li>Line numbers from 0-32767</li>
<li>Classic BASIC syntax and semantics</li>
</ul>
<h1><a class="anchor" id="autotoc_md249"></a>
DOS/ProDOS Commands</h1>
<p>File system commands are implemented with modern cross-platform file I/O:</p>
<ul>
<li><code>LOAD "filename"</code> - Load a BASIC program</li>
<li><code>SAVE "filename"</code> - Save the current program</li>
<li><code>CATALOG</code> - List files in the current directory</li>
</ul>
<h1><a class="anchor" id="autotoc_md250"></a>
Development Status</h1>
<p>This is a working interpreter with comprehensive Applesoft BASIC features implemented. The following areas are still in development:</p>
<ul>
<li><b><a class="el" href="classGraphics.html" title="Singleton managing graphics state and operations.">Graphics</a> Rendering</b>: <a class="el" href="classGraphics.html" title="Singleton managing graphics state and operations.">Graphics</a> commands are implemented with Raylib support for window rendering. When Raylib is not available or no display is present, graphics fall back to off-screen buffer mode.</li>
<li><b>Font Rendering</b>: The Ultimate Apple II Font integration is planned for future releases for authentic text rendering in graphics mode.</li>
<li><b>Sound Commands</b>: BELL is implemented; other sound/audio commands not yet supported</li>
<li><b>Hardware-Specific Features</b>: Some Apple II-specific hardware commands are stubbed (PDL returns 0, USR returns 0, etc.)</li>
</ul>
<h1><a class="anchor" id="autotoc_md251"></a>
License</h1>
<p>This project is open source. See LICENSE file for details.</p>
<h1><a class="anchor" id="autotoc_md252"></a>
Contributing</h1>
<p>Contributions are welcome! Please feel free to submit pull requests or open issues for bugs and feature requests. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Dec 23 2025 21:52:02 for MSBasic - Applesoft BASIC Interpreter by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
